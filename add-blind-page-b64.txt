# add-blind-page-b64.ps1  (PS 5.1 & 7)
param(
  [string]$WebRoot = "C:\Users\millh_y3006x1\Desktop\WholeHogWeb"
)

[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
function Write-Bytes([string]$Path,[byte[]]$Bytes){
  $dir = Split-Path $Path -Parent
  if($dir -and -not (Test-Path $dir)){ New-Item -ItemType Directory -Force -Path $dir | Out-Null }
  [IO.File]::WriteAllBytes($Path,$Bytes)
}

if(-not (Test-Path $WebRoot)){ throw "Web root not found: $WebRoot" }
$cfg = Join-Path $WebRoot 'supabase-config.js'
if(-not (Test-Path $cfg)){
  Write-Warning "supabase-config.js not found in $WebRoot. The blind page expects it."
}

# ---------- blind.html (base64) ----------
$b64Html = @'
PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNl
dD0idXRmLTgiLz4KICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2
aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSIvPgogIDx0aXRsZT5CbGluZCBUYXN0ZSBTY29y
aW5nPC90aXRsZT4KICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9InN0eWxlcy5jc3Mi
PgogIDxzY3JpcHQgc3JjPSJzdXBhYmFzZS1jb25maWcuanMiPjwvc2NyaXB0PgogIDxz dHls
ZT4KICAgIC8qIFBhZ2Utc3BlY2lmaWMgZmFsbGJhY2tzOyB5b3VyIGV4aXN0aW5nIHN0eWxl
cy5jc3Mgd2lsbCBzdGlsbCBhcHBseSAqLwogICAgLnBhZ2Utd3JhcHtmax13aWR0aDoxMjAw
cHg7bWFyZ2luOjAgYXV0bztwYWRkaW5nOjEycHg7fQogICAgLmdyaWQtdHdve2Rpc3BsYXk6
Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZml0LG1pbm1heCgzNDBw
eCwxfHIpKTtnYXA6MTRweDt9CiAgICAucGFuZWx7bWFyZ2luOjEwcHggMDt9CiAgICAuY2Fy
ZHtiYWNrZ3JvdW5kOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCAjZGRkO2JvcmRlci1yYWRpdXM6
MTRweDtwYWRkaW5nOjE0cHg7fQogICAgLnJvd3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0
ZS1jb2x1bW5zOjE2MHB4IDFmcjtnYXA6MTBweDthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2lu
OjhweCAwO30KICAgIC5zY29yZS1ncmlke2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNv
bHVtbnM6cmVwZWF0KGF1dG8tZml0LG1pbm1heCgyMjBweCwxfHIpKTtnYXA6MTJweDt9CiAg
ICAubWluaS1jYXJke2JhY2tncm91bmQ6I2ZmZjti b3JkZXI6MXB4IHNvbGlkICNkZGQ7Ym9y
ZGVyLXJhZGl1czoxMnB4O3BhZGRpbmc6MTBweDtwb3NpdGlvbjpyZWxhdGl2ZTttaW4taGVp
Z2h0Ojk2cHg7fQogICAgLm1pbmktaGVhZHtmb250LXdlaWdodDo3MDA7bWFyZ2luLWJvdHRv
bTo4cHg7fQogICAgLnJhbmdleyN1bmQ7Y29sb3I6I2Y2Njtmb250LXdlaWdodDo0MDA7bWFy
Z2luLWxlZnQ6NHB4O30KICAgIC5waWNrZXItYnRu e3dpZHRoOjEwMCU7cGFkZGluZzoxMHB4
IDEycHg7Ym9yZGVyOjFweCBzb2xpZCAjYmJiO2JvcmRlci1yYWRpdXM6MTBweDtiYWNrZ3Jv
dW5kOiNmOGY4Zjg7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NjAwO30KICAgIC5vcHRp
b25ze2Rpc3BsYXk6bm9uZTttYXJnaW4tdG9wOjhweDti b3JkZXItdG9wOjFweCBkYXNoZWQg
I2RkZDtwYWRkaW5nLXRvcDo4cHg7fQogICAgLm9wdGlvbnMuc2hvd3tk aXNwbGF5OmJsb2Nr
O30KICAgIC5vcHRpb25zIC5vcHR7bWFyZ2luOjRweCA0cHggMCAwO3BhZGRpbmc6NnB4IDhw
eDtib3JkZXI6MXB4IHNvbGlkICNiYmI7YmFja2dyb3VuZDojZmZmO2JvcmRlci1yYWRpdXM6
OHB4O2N1cnNvcjpwb2ludGVyO30KICAgIC50b3RhbC1yb3d7ZGlzcGxheTpncmlkO2dyaWQt
dGVtcGxhdGUtY29sdW1uczogNjBweCAxZnIgYXV0bztnYXA6MTBweDthbGlnbi1pdGVtczpj
ZW50ZXI7bWFyZ2luLXRvcDoxMnB4O30KICAgIC50b3RhbC1sYWJlbHtmb250LXdlaWdodDo3
MDA7fQogICAgLnRvdGFsLXZhbHtmb250LXdlaWdodDo4MDA7Zm9udC1zaXplOjEuMnJlbTt9
CiAgICAuYnRuLXByaW1hcnl7YmFja2dyb3VuZDojMGI0ZmZmO2NvbG9yOiNmZmY7Ym9yZGVy
OjA7Ym9yZGVyLXJhZGl1czoxMHB4O3BhZGRpbmc6MTBweCAxNnB4O2ZvbnQtd2VpZ2h0Ojc w
MDtjdXJzb3I6cG9pbnRlcjt9CiAgICBoZWFkZXIuaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZl
O2hlaWdodDoyLjI1aW47bWluLWhlaWdodDoyLjI1aW47bGluZS1oZWlnaHQ6Mi4yNWluO30K
ICAgIGhlYWRlci5oZWFkZXIgaW1nI2xvZ29MZWZ0e3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6
MThweDt0b3A6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpO2hlaWdodDpjYWxjKDEw
MCUgLSAyNHB4KTt3aWR0aDphdXRvO30KICAgIGhlYWRlci5oZWFkZXIgaW1nLnJpZ2h0LWlt
Z3twb3NpdGlvbjphYnNvbHV0ZTtyaWdodDoxOHB4O3RvcDo1MCU7dHJhbnNmb3JtOnRyYW5z
bGF0ZVkoLTUwJSk7aGVpZ2h0OmNhbGMoMTAwJSAtIDI0cHgpO3dpZHRoOmF1dG87fQogICAga
GVhZGVyLmhlYWRlciBoMXttYXJnaW46MDt0ZXh0LWFsaWduOmNlbnRlcjtsaW5lLWhlaWdo
dDpub3JtYWw7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3JpZ2h0OjA7dG9wOjUwJTsKdHJh
bnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSk7fQogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAg
PGhlYWRlciBjbGFzcz0iaGVhZGVyIj4KICAgIDxpbWcgaWQ9ImxvZ29MZWZ0IiBzcmM9Ikxl
Z2lvbiB3aG9sZSBob2cgbG9nby5wbmciIGFsdD0iV2hvbGUgSG9nIj4KICAgIDxoMT5CbGlu
ZCBUYXN0ZSBTY29yaW5nPC9oMT4KICAgIDxpbWcgY2xhc3M9InJpZ2h0LWltZyIgc3JjPSJB
TCBNZWRhbGxpb24ucG5nIiBhbHQ9IkFtZXJpY2FuIExlZ2lvbiI+CiAgPC9oZWFkZXI+Cgog
IDxtYWluIGNsYXNzPSJwYWdlLXdyYXAiPgogICAgPHNlY3Rpb24gY2xhc3M9InBhbmVsIj4K
ICAgICAgPGRpdiBjbGFzcz0iZ3JpZC10d28iPgogICAgICAgIDxkaXYgY2xhc3M9ImNhcmQi
PgogICAgICAgICAgPGgyPkp1ZGdlICYgQ2hpcDwvaDI+CiAgICAgICAgICA8ZGl2IGNsYXNz
PSJyb3ciPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJqdWRnZVNlbGVjdCI+SnVkZ2U8L2xh
YmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJqdWRnZVNlbGVjdCI+PG9wdGlvbiB2YWx1
ZT0iIj5Mb2FkaW5nIGp1ZGdlcy7igIs8L29wdGlvbj48L3NlbGVjdD4KICAgICAgICAgIDwv
ZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgICAgICAgPGxhYmVsIGZv
cj0iY2hpcElucHV0Ij5DaGlwIE51bWJlcjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCBp
ZD0iY2hpcElucHV0IiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iZS5nLiwgMjAzIiAvPgog
ICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImNh
cmQiIGlkPSJzY29yaW5nQ2FyZCI+CiAgICAgICAgICA8aDI+U2NvcmVzPC9oMj4KICAgICAg
ICAgIDxkaXYgY2xhc3M9InNjb3JlLWdyaWQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJt
aW5pLWNhcmQiIGlkPSJjYXJkQXBwZWFyYW5jZSI+CiAgICAgICAgICAgICAgPGRpdiBjbGFz
cz0ibWluaS1oZWFkIj5BcHBlYXJhbmNlIDxzcGFuIGNsYXNzPSJyYW5nZSI+KDI44oCTNDAp
PC9zcGFuPjwvZGl2PgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InBpY2tlci1idG4i
IGRhdGEtZm9yPSJhcHBlYXJhbmNlIj48c3BhbiBjbGFzcz0ic2VsIj5DaG9vc2U8L3NwYW4+
PC9idXR0b24+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3B0aW9ucyIgZGF0YS1mb3I9
ImFwcGVhcmFuY2UiPjwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxk
aXYgY2xhc3M9Im1pbmktY2FyZCIgaWQ9ImNhcmRUZW5kZXJuZXNzIj4KICAgICAgICAgICAg
ICA8ZGl2IGNsYXNzPSJtaW5pLWhlYWQiPlRlbmRlcm5lc3MgPHNwYW4gY2xhc3M9InJhbmdl
Ij4oMuKAkzQwKTwvc3Bhbj48L2Rpdj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJw
aWNrZXItYnRuIiBkYXRhLWZvcj0idGVuZGVybmVzcyI+PHNwYW4gY2xhc3M9InNlbCI+Q2hv
b3NlPC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im9wdGlvbnMi
IGRhdGEtZm9yPSJ0ZW5kZXJuZXNzIj48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAg
ICAgICAgICA8ZGl2IGNsYXNzPSJtaW5pLWNhcmQiIGlkPSJjYXJkVGFzdGUiPgogICAgICAg
ICAgICAgIDxkaXYgY2xhc3M9Im1pbmktaGVhZCI+VGFzdGUgPHNwYW4gY2xhc3M9InJhbmdl
Ij4oNOKAkyA4MCk8L3NwYW4+PC9kaXY+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0i
cGlja2VyLWJ0biIgZGF0YS1mb3I9InRhc3RlIj48c3BhbiBjbGFzcz0ic2VsIj5DaG9vc2U8
L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3B0aW9ucyIgZGF0
YS1mb3I9InRhc3RlIj48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rp
dj4KCiAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b3RhbC1yb3ciPgogICAgICAgICAgICA8ZGl2
IGNsYXNzPSJ0b3RhbC1sYWJlbCI+VG90YWw8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFz
cz0idG90YWwtdmFsIiBpZD0idG90YWxEaXNwbGF5Ij4wPC9kaXY+CiAgICAgICAgICAgIDxi
dXR0b24gaWQ9InNhdmVCdG4iIGNsYXNzPSJidG4tcHJpbWFyeSI+U2F2ZTwvYnV0dG9uPgog
ICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9zZWN0
aW9uPgoKICAgIDxzZWN0aW9uIGNsYXNzPSJwYW5lbCI+CiAgICAgIDxoMj5MZWFkZXJib2Fy
ZCAoQmxpbmQpPC9oMj4KICAgICAgPGRpdiBpZD0ibGVhZGVyYm9hcmQiPkxvYWRpbmfigIs8
L2Rpdj4KICAgIDwvc2VjdGlvbj4KICA8L21haW4+CgogIDxzY3JpcHQgc3JjPSJibGluZC1z
Yi5qcyI+PC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=
'@

# ---------- blind-sb.js (base64) ----------
$b64Js = @'
KGZ1bmN0aW9uKCl7CiAgJ3VzZSBzdHJpY3QnOwoKICBmdW5jdGlvbiAkKHNlbCl7IHJldHVy
biBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbCk7IH0KICBmdW5jdGlvbiAkYWxsKHNlbCl7
IHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVj
dG9yQWxsKHNlbCkpOyB9CgoKICAvLyBNaW5pbWFsIGZldGNoIGhlbHBlcnMgKHJlLXVzZSBX
SE9MRUhPRy5zYiBpZiBwcmVzZW50KQogIGZ1bmN0aW9uIHNiR2V0KHBhdGgpewogICAgaWYod2luZG93
LldIT0xFSE9HICYmIHdpbmRvdy5XSE9MRUhPRy5zYiAmJiB3aW5kb3cuV0hPTEVIT0cu
c2IuZ2V0KXsKICAgICAgcmV0dXJuIHdpbmRvdy5XSE9MRUhPRy5zYi5nZXQocGF0aCku
dGhlbihmdW5jdGlvbihyKXsgcmV0dXJuIHIuanNvbigpOyB9KTsKICAgIH0KICAgIC8vIGZh
bGxiYWNrIChleHBlY3RzIHN1cGFiYXNlLWNvbmZpZy5qcyBzZXQgcHJvamVjdC9rZXkpCiAg
ICB2YXIgYmFzZSA9ICh3aW5kb3cuV0hPTEVIT0cgJiYgd2luZG93LldIT0xFSE9HLnNiUHJv
amVjdFVybCkgPyB3aW5kb3cuV0hPTEVIT0cu c2JQcm9qZWN0VXJsIDogJyc7CiAgICByZXR1
cm4gZmV0Y2goYmFzZSArIHBhdGgsIHsKICAgICAgbWV0aG9kOidHRVQnLAogICAgICBoZWFk
ZXJzOnsKICAgICAgICAnYXBpa2V5JzogKHdpbmRvdy5XSE9MRUhPRyAmJiB3aW5kb3cuV0hP
TEVIT0cuc2JBbm9uS2V5KSB8fCAnJywKICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFy
ZXIgJyArICgod2luZG93LldIT0xFSE9HICYmIHdpbmRvdy5XSE9MRUhPRy5zQmFub25LZXkp
IHx8ICcnKQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uKHIpeyByZXR1cm4gci5qc29u
KCk7IH0pOwogIH0KICBmdW5jdGlvbiBzYlBvc3QocGF0aCwgYm9keSl7CiAgICBpZih3aW5k
b3cuV0hPTEVIT0cgJiYgd2luZG93LldIT0xFSE9HLnNiICYmIHdpbmRvdy5XSE9MRUhPRy5z
Yi5wb3N0KXsKICAgICAgcmV0dXJuIHdpbmRvdy5XSE9MRUhPRy5zYi5wb3N0KHBhdGgsIGJv
ZHkpLnRoZW4oZnVuY3Rpb24oci){CBSB7IHJldHVybiByLmpzb24oKTsgfSk7CiAgICB9CiAg
ICB2YXIgYmFzZSA9ICh3aW5kb3cuV0hPTEVIT0cgJiYgd2luZG93LldIT0xFSE9HLnNiUHJv
amVjdFVybCkgPyB3aW5kb3cuV0hPTEVIT0cu c2JQcm9qZWN0VXJsIDogJyc7CiAgICByZXR1
cm4gZmV0Y2goYmFzZSArIHBhdGgsIHsKICAgICAgbWV0aG9kOidQT1NUJywKICAgICAgaGVh
ZGVyczp7CiAgICAgICAgJ2FwaWtleSc6ICh3aW5kb3cuV0hPTEVIT0cgJiYgd2luZG93LldI
T0xFSE9HLnNCQW5vbktleSkgfHwgJycsCiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVh
cmVyICcgKyAoKHdpbmRvdy5XSE9MRUhPRyAmJiB3aW5kb3cuV0hPTEVIT0cuc0Jhb25LZXkp
IHx8ICcnKSwKICAgICAgICAnQ29udGVudC1UeXBlJzonYXBwbGljYXRpb24vanNvbi csCiAg
ICAgICAgJ1ByZWZlcic6J3JldHVybi1yZXByZXNlbnRhdGlvbicKICAgICAgfSwKICAgICAg
Ym9keTogSlNPTi5zdHJpbmdpZnk oYm9keSkKICAgIH0pLnRoZW4oZnVuY3Rpb24oci){CBSB7
IHJldHVybiByLmpzb24oKTsgfSk7CiAgfQoKICAvLyBCdWlsZCBzY29yZSBwaWNrZXJzCiAg
dmFyIHNjb3JlcyA9IHsgYXBwZWFyYW5jZTpudWxsLCB0ZW5kZXJuZXNzOm51bGwsIHRhc3Rl
Om51bGwgfTsKCiAgZnVuY3Rpb24gYnVpbGRPcHRpb25zKGNvbnRhaW5lciwgbWluLCBtYXgs
IHN0ZXApewogICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50
KCk7CiAgICBmb3IodmFyIHY9bWluOyB2PD0gbWF4OyB2Kz1zdGVwKXsKICAgICAgdmFyIGIg
PSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgYi50eXBlID0gJ2J1
dHRvbic7CiAgICAgIGIuY2xhc3NOYW1lID0gJ29wdCc7CiAgICAgIGIudGV4dENvbnRlbnQg
PSBTdHJpbmcodikpOwogICAgICAoZnVuY3Rpb24odmFsKXsKICAgICAgICBiLmFkZEV2ZW50
TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXsKICAgICAgICAgIHZhciBrZXkgPSBjb250
YWluZXIuZ2V0QXR0cmlidXRlKCdkYXRhLWZvcicpOwogICAgICAgICAgc2NvcmVzW2tleV0g
PSB2YWw7CiAgICAgICAgICB2YXIg c2VsRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdi
dXR0b24ucGlja2VyLWJ0bltkYXRhLWZvcj0iJyt rZXkrJyJdIC5zZWwnKTsKICAgICAgICAg
IGlmKHNlbEVsKXsgc2VsRWwudGV4dENvbnRlbnQgPSBTdHJpbmcodik7IH0KICAgICAgICAg
IGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICB1cGRhdGVU
b3RhbCgpOwogICAgICAgIH0pOwogICAgICB9KSh2KTsKICAgICAgZnJhZy5hcHBlbmRDaGls
ZChiKTsKICAgIH0KICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgIGNvbnRhaW5l
ci5hcHBlbmRDaGlsZChmcmFnKTsKICB9CgogIGZ1bmN0aW9uIGF0dGFjaFBpY2tlcihrZXks
IG1pbiwgbWF4LCBzdGVwKXsKICAgIHZhciBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9y
KCdidXR0b24ucGlja2VyLWJ0bltkYXRhLWZvcj0iJyt rZXkrJyJdJyk7CiAgICB2YXIgYm94
ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2Lm9wdGlvbnNbZGF0YS1mb3I9Iicr a2V5
Kyc iXScpOwogICAgaWYoIWJ0biB8fCAhYm94KSByZXR1cm47CiAgICBidWlsZE9wdGlvbnMo
Ym94LCBtaW4sIG1heCwgc3RlcCk7CiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2sn
LCBmdW5jdGlvbigpewogICAgICAvLyBjbG9zZSBvdGhlcnMKICAgICAgJGFsbCgnZGl2Lm9w
dGlvbnMuc2hvdycpLmZvckVhY2goZnVuY3Rpb24oZWwpeyBpZihlbCE9Ym94KSBlbC5jbGFz
c0xpc3QucmVtb3ZlKCdzaG93Jyk7IH0pOwogICAgICBib3guY2xhc3NMaXN0LnRvZ2dsZSgn
c2hvdycpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVUb3RhbCgpewogICAgdmFy
IGEgPSBzY29yZXMuYXBwZWFyYW5jZXx8MCwgdCA9IHNjb3Jlcy50ZW5kZXJuZXNzfHwwLCB0
YSA9IHNjb3Jlcy50YXN0ZXx8MDsKICAgIHZhciB0ZCA9IGRvY3VtZW50LmdldEVsZW1lbnRC
eUlkKCd0b3RhbERpc3BsYXknKTsKICAgIGlmKHRkKSB0ZC50ZXh0Q29udGVudCA9IFN0cmlu
ZyhhK3QrdGEpOwogIH0KCiAgZnVuY3Rpb24gbG9hZEp1ZGdlcygpewogICAgdmFyIHNlbCA9
IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdqdWRnZVNlbGVjdCcpOwogICAgaWYoIXNlbCkg
cmV0dXJuOwogICAgc2VsLmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSIiPkxvYWRpbmfigIs8L29w
dGlvbj4nOwogICAgc2JHZXQoJy9yZXN0L3YxL2p1ZGdlcz9zZWxlY3Q9aWQsbmFtZSZvcmRl
cj1uYW1lJykudGhlbihmdW5jdGlvbihyb3dzKXsKICAgICAgc2VsLmlubmVySFRNTCA9ICc8
b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBqdWRnZeuCizwvb3B0aW9uPic7CiAgICAgIChyb3dz
fHxbXSk uZm9yRWFjaChmdW5jdGlvbihyKXsKICAgICAgICB2YXIgbz0gZG9jdW1lbnQuY3Jl
YXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgby52YWx1ZSA9IHIuaWQ7IG8udGV4dENv
bnRlbnQgPSByLm5hbWU7CiAgICAgICAgc2VsLmFwcGVuZENoaWxkKG8pOwogICAgICB9KTsK
ICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCl7CiAgICAgIHNlbC5pbm5lckhUTUwgPSAnPG9wdGlv
biB2YWx1ZT0iIj5FcnJvciBsb2FkaW5nIGp1ZGdlczwvb3B0aW9uPic7CiAgICB9KTsKICB9
CgogIGZ1bmN0aW9uIHNhdmVFbnRyeSgpewogICAgdmFyIGp1ZGdlU2VsID0gZG9jdW1lbnQu
Z2V0RWxlbWVudEJ5SWQoJ2p1ZGdlU2VsZWN0Jyk7CiAgICB2YXIgY2hpcEVsICAgPSBkb2N1
bWVudC5nZXRFbGVtZW50QnlJZCgnY2hpcElucHV0Jyk7CiAgICBpZighanVkZ2VTZWwgfHwg
IWNoaXBFbCl7IGFsZXJ0KCdQYWdlIG1pc3NpbmcganVkZ2UvY2hpcCBjb250cm9scycpOyBy
ZXR1cm47IH0KCiAgICB2YXIg anVkZ2VJZCA9IGp1ZGdlU2VsLnZhbHVlOwogICAgdmFyIGNo
aXAgPSAoY2hpcEVsLnZhbHVlfHwnJykudHJpbSgpOwogICAgaWYoIWp1ZGdlSWQpeyBhbGVy
dCgnUGljayBhIGp1ZGdlJyk7IHJldHVybjsgfQogICAgaWYoIWNoaXAp e yBhbGVydCgnRW50
ZXIgYSBjaGlwIG51bWJlcicpOyByZXR1cm47IH0KICAgIGlmKHNjb3Jlcy5hcHBlYXJhbmNl
PT1udWxsIHx8IHNjb3Jlcy50ZW5kZXJuZXNzPT1udWxsIHx8IHNjb3Jlcy50YXN0ZT09bnVs
bCl7CiAgICAgIGFsZXJ0KCdQaWNrIGFsbCB0aHJlZSBzY29yZXMnKTsgcmV0dXJuOyB9CiAg
ICB2YXIgYm9keSA9IFt7CiAgICAgIGp1ZGdlX2lkOiBqdWRnZUlkLAogICAgICBjaGlwX251
bWJlcjogY2hpcCwKICAgICAgYXBwZWFyYW5jZTogc2NvcmVzLmFwcGVhcmFuY2UsCiAgICAg
IHRlbmRlcm5lc3M6IHNjb3Jlcy50ZW5kZXJuZXNzLAogICAgICB0YXN0ZTogc2NvcmVzLnRh
c3RlCiAgICB9XTsKICAgIHNiUG9zdCgnL3Jlc3QvdjEvYmxpbmRfZW50cmllcycsIGJvZHkp
LnRoZW4oZnVuY3Rpb24ocmVzcCl7CiAgICAgIGlmKEFycmF5LmlzQXJyYXkocmVzcCkgJiYg
cmVzcC5sZW5ndGgpewogICAgICAgIC8vIHJlc2V0IFVJIGFuZCByZWZyZXNoIGxlYWRlcmJv
YXJkCiAgICAgICAgc2NvcmVzLmFwcGVhcmFuY2UgPSBzY29yZXMudGVuZGVybmVzcyA9IHNj
b3Jlcy50YXN0ZSA9IG51bGw7CiAgICAgICAgJGFsbCgnLnBpY2tlci1idG4gLnNlbCcpLmZv
ckVhY2goZnVuY3Rpb24ocyl7IHMudGV4dENvbnRlbnQ9J0Nob29zZSc7IH0pOwogICAgICAg
IHVwZGF0ZVRvdGFsKCk7CiAgICAgICAgY2hpcEVsLnZhbHVlPScnOwogICAgICAgIHJlZnJl
c2hMZWFkZXJib2FyZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUud2Fybign
U2F2ZSByZXNwb25zZScsIHJlc3ApOwogICAgICAgIGFsZXJ0KCdDb3VsZCBub3Qgc2F2ZSAo
Y2hlY2sgU3VwYWJhc2UgdGFibGUgJiBSTFMpLicpOwogICAgICB9CiAgICB9KS5jYXRjaChm
dW5jdGlvbihlcnIpewogICAgICBjb25zb2xlLmVycm9yKGVy cik7CiAgICAgIGFsZXJ0KCdF
cnJvciBzYXZpbmcgc2NvcmUuJyk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIHJlZnJlc2hM
ZWFkZXJib2FyZCgpewogICAgLy8gRXhwZWN0IGEgdmlldyB2X2JsaW5kX2xlYWRlcmJvYXJk
CiAgICBzYkdldCgnL3Jlc3QvdjE vdl9ibGluZF9sZWFkZXJib2FyZD9zZWxlY3Q9Y2hpcF9u
dW1iZXIsdG90YWxfcG9pbnRzLHRpZV90YXN0ZSx0aWVfdGVuZGVybmVzcyx0aWVfYXBwZWFy
YW5jZSZvcmRlcj10b3RhbF9wb2ludHMuZGVzYyx0aWVfdGFzdGUuZGVzYyx0aWVfdGVuZGVy
bmVzcy5kZXNjLHRpZV9hcHBlYXJhbmNlLmRlc2MmbGltaXQ9MjAnKQogICAgICAudGhlbihm
dW5jdGlvbihyb3dzKXsKICAgICAgICB2YXIgaG9zdCA9IGRvY3VtZW50LmdldEVsZW1lbnRC
eUlkKCdsZWFkZXJib2FyZCcpOwogICAgICAgIGlmKCFob3N0KSByZXR1cm47CiAgICAgICAg
aWYoIXJvd3MgfHwgIXJvd3MubGVuZ3RoKXsg aG9zdC50ZXh0Q29udGVudD0nTm8gc2NvcmVz
IHlldC4nOyByZXR1cm47IH0KICAgICAgICB2YXIgaHRtbCA9ICc8dGFibGUgY2xhc3M9Imxi
Ij48dGhlYWQ+PHRyPjx0aD5SYW5rPC90aD48dGg+Q2hpcDwvdGg+PHRoPlRvdGFsPC90aD48
L3RyPjwvdGhlYWQ+PHRib2R5Pic7CiAgICAgICAgcm93cy5mb3JFYWNoKGZ1bmN0aW9uKHI s
IGlkeCl7CiAgICAgICAgICBodG1sICs9ICc8dHI+PHRkPicrKGlkeCsxKSsnPC90ZD48dGQ+
JytyLmNoaXBfbnVtYmVyKyc8L3RkPjx0ZD4nK3IudG90YWxfcG9pbnRzKyc8L3RkPjwvdHI+
JzsKICAgICAgICB9KTsKICAgICAgICBodG1sICs9ICc8L3Rib2R5PjwvdGFibGU+JzsKICAg
ICAgICBob3N0LmlubmVySFRNTCA9IGh0bWw7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCl7
CiAgICAgICAgdmFyIGhvc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVhZGVyYm9h
cmQnKTsKICAgICAgICBpZihoaW9zdCkgaG9zdC50ZXh0Q29udGVudCA9ICdMZWFkZXJib2Fy
ZCB2aWV3IG1pc3NpbmcgKHJ1biBTUUwgc3RlcCkuJzsKICAgICAgfSk7CiAgfQoKICAvLyBJ
bml0CiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXsK
ICAgIC8vIGNsaWNrIG91dHNpZGUgY2xvc2VzIG1lbnVzCiAgICBpZighZS50YXJnZXQuY2xv
c2VzdCgnLm1pbmktY2FyZCcpKXsgJGFsbCgnLm9wdGlvbnMuc2hvdycpLmZvckVhY2goZnVu
Y3Rpb24oeCl7IHguY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOyB9KTsgfQogIH0pOwoKICBh
dHRhY2hQaWNrZXIoJ2FwcGVhcmFuY2UnLCAyLCA0MCwgMik7CiAgYXR0YWNoUGlja2VyKCd0
ZW5kZXJuZXNzJywgMiwgNDAsIDIpOwogIGF0dGFjaFBpY2tlcigndGFzdGUnLCA0LCA4MCwg
NCk7CiAgdXBkYXRlVG90YWwoKTsKICBsb2FkSnVkZ2VzKCk7CiAgcmVmcmVzaExlYWRlcmJv
YXJkKCk7CgogIHZhciBzYXZlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVC
dG4nKTsKICBpZihzYXZlQnRuKXsgc2F2ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycs
IHNhdmVFbnRyeSk7IH0KfSkoKTs=
'@

# Write files
$blindHtmlPath = Join-Path $WebRoot 'blind.html'
$blindJsPath   = Join-Path $WebRoot 'blind-sb.js'

Write-Bytes $blindHtmlPath ([Convert]::FromBase64String($b64Html))
Write-Bytes $blindJsPath   ([Convert]::FromBase64String($b64Js))

Write-Host "Wrote:" -ForegroundColor Cyan
Write-Host " - $blindHtmlPath"
Write-Host " - $blindJsPath"

# Optional: open in default browser
try { Start-Process $blindHtmlPath } catch {}
Write-Host "Done. If cached, press Ctrl+F5 in your browser." -ForegroundColor Green
